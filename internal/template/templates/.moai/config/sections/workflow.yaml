workflow:
    auto_clear:
        after_plan: true
        after_run: false
        enabled: true
        token_threshold: 150000
    completion:
        detect_in_output: true
        markers:
            complete: <moai>COMPLETE</moai>
            done: <moai>DONE</moai>
    execution_mode: team
    loop_prevention:
        failure_pattern_detection: true
        max_iterations: 100
        max_retries_per_operation: 3
    team:
        auto_selection:
            min_complexity_score: 7
            min_domains_for_team: 3
            min_files_for_team: 10
        default_model: sonnet
        delegate_mode: true
        enabled: true
        max_teammates: 10
        patterns:
            design_implementation:
                description: Cross-layer feature implementation with UI/UX design
                model: inherit
                roles:
                    - designer
                    - backend-dev
                    - frontend-dev
                    - tester
            full_stack:
                description: Full-stack implementation with quality gate
                model: inherit
                roles:
                    - api-layer
                    - ui-layer
                    - data-layer
                    - quality
            implementation:
                description: Cross-layer feature implementation
                model: inherit
                roles:
                    - backend-dev
                    - frontend-dev
                    - tester
            investigation:
                description: Competing hypothesis debugging
                model: haiku
                roles:
                    - hypothesis-1
                    - hypothesis-2
                    - hypothesis-3
            plan_research:
                description: Parallel SPEC research and design
                model: inherit
                roles:
                    - researcher
                    - analyst
                    - architect
            review:
                description: Multi-perspective code review
                model: inherit
                roles:
                    - security-reviewer
                    - perf-reviewer
                    - quality-reviewer
                    - ux-reviewer
        require_plan_approval: true
        teammate_display: auto
    token_budget:
        plan: 30000
        run: 180000
        sync: 40000
